<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/MainActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/MainActivity.kt" />
              <option name="originalContent" value="package com.example.attendance_tracker&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.ui.Modifier&#10;import com.example.attendance_tracker.ui.navigation.AppNavHost&#10;import com.example.attendance_tracker.ui.navigation.BottomNavItem&#10;import com.example.attendance_tracker.ui.theme.LOLTheme&#10;import androidx.navigation.compose.rememberNavController&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.room.Room&#10;import com.example.attendance_tracker.data.AppDatabase&#10;import com.example.attendance_tracker.data.SubjectRepository&#10;import com.example.attendance_tracker.repository.TimetableRepository&#10;import com.example.attendance_tracker.viewmodel.TimetableViewModel&#10;import com.example.attendance_tracker.viewmodel.TimetableViewModelFactory&#10;import androidx.compose.runtime.remember&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        setContent {&#10;            LOLTheme {&#10;                val navController = rememberNavController()&#10;                val context = this&#10;                val db = remember {&#10;                    Room.databaseBuilder(&#10;                        context.applicationContext,&#10;                        AppDatabase::class.java,&#10;                        &quot;attendance_db&quot;&#10;                    )&#10;                    .fallbackToDestructiveMigration()&#10;                    .build()&#10;                }&#10;                val repository = remember { SubjectRepository(db.subjectDao()) }&#10;                val timetableRepository = remember { TimetableRepository(db.timetableDao()) }&#10;                val timetableViewModel: TimetableViewModel = androidx.lifecycle.viewmodel.compose.viewModel(&#10;                    factory = TimetableViewModelFactory(timetableRepository)&#10;                )&#10;                val items = listOf(&#10;                    BottomNavItem.Home,&#10;                    BottomNavItem.Subjects,&#10;                    BottomNavItem.Timetable,&#10;                    BottomNavItem.CommonSlots&#10;                )&#10;                val commonSlotViewModel: com.example.attendance_tracker.viewmodel.CommonSlotViewModel = androidx.lifecycle.viewmodel.compose.viewModel()&#10;                // Always call insertDefaultSlotsIfEmpty; it only inserts if table is empty&#10;                commonSlotViewModel.insertDefaultSlotsIfEmpty()&#10;                val attendanceRepository = remember { com.example.attendance_tracker.repository.AttendanceRepository(db.attendanceDao(), db.subjectDao(), repository) }&#10;                val attendanceViewModel = remember { com.example.attendance_tracker.viewmodel.AttendanceViewModel(attendanceRepository) }&#10;                Scaffold(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    bottomBar = {&#10;                        NavigationBar {&#10;                            val currentRoute = navController.currentBackStackEntry?.destination?.route&#10;                            items.forEach { item -&gt;&#10;                                NavigationBarItem(&#10;                                    icon = { Icon(item.icon, contentDescription = item.label) },&#10;                                    label = { Text(item.label) },&#10;                                    selected = currentRoute == item.route,&#10;                                    onClick = {&#10;                                        if (currentRoute != item.route) {&#10;                                            navController.navigate(item.route) {&#10;                                                popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                                launchSingleTop = true&#10;                                                restoreState = true&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                ) { innerPadding -&gt;&#10;                    AppNavHost(&#10;                        navController = navController,&#10;                        repository = repository,&#10;                        timetableViewModel = timetableViewModel,&#10;                        commonSlotViewModel = commonSlotViewModel,&#10;                        attendanceViewModel = attendanceViewModel,&#10;                        modifier = Modifier.padding(innerPadding)&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.attendance_tracker&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.ui.Modifier&#10;import com.example.attendance_tracker.ui.navigation.AppNavHost&#10;import com.example.attendance_tracker.ui.navigation.BottomNavItem&#10;import com.example.attendance_tracker.ui.theme.LOLTheme&#10;import androidx.navigation.compose.rememberNavController&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.room.Room&#10;import com.example.attendance_tracker.data.AppDatabase&#10;import com.example.attendance_tracker.data.SubjectRepository&#10;import com.example.attendance_tracker.repository.TimetableRepository&#10;import com.example.attendance_tracker.viewmodel.TimetableViewModel&#10;import com.example.attendance_tracker.viewmodel.TimetableViewModelFactory&#10;import androidx.compose.runtime.remember&#10;import androidx.work.ExistingPeriodicWorkPolicy&#10;import androidx.work.PeriodicWorkRequestBuilder&#10;import androidx.work.WorkManager&#10;import com.example.attendance_tracker.worker.AttendanceReminderWorker&#10;import java.util.Calendar&#10;import java.util.concurrent.TimeUnit&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        setContent {&#10;            LOLTheme {&#10;                val navController = rememberNavController()&#10;                val context = this&#10;                val db = remember {&#10;                    Room.databaseBuilder(&#10;                        context.applicationContext,&#10;                        AppDatabase::class.java,&#10;                        &quot;attendance_db&quot;&#10;                    )&#10;                    .fallbackToDestructiveMigration()&#10;                    .build()&#10;                }&#10;                val repository = remember { SubjectRepository(db.subjectDao()) }&#10;                val timetableRepository = remember { TimetableRepository(db.timetableDao()) }&#10;                val timetableViewModel: TimetableViewModel = androidx.lifecycle.viewmodel.compose.viewModel(&#10;                    factory = TimetableViewModelFactory(timetableRepository)&#10;                )&#10;                val items = listOf(&#10;                    BottomNavItem.Home,&#10;                    BottomNavItem.Subjects,&#10;                    BottomNavItem.Timetable,&#10;                    BottomNavItem.CommonSlots&#10;                )&#10;                val commonSlotViewModel: com.example.attendance_tracker.viewmodel.CommonSlotViewModel = androidx.lifecycle.viewmodel.compose.viewModel()&#10;                // Always call insertDefaultSlotsIfEmpty; it only inserts if table is empty&#10;                commonSlotViewModel.insertDefaultSlotsIfEmpty()&#10;                val attendanceRepository = remember { com.example.attendance_tracker.repository.AttendanceRepository(db.attendanceDao(), db.subjectDao(), repository, timetableRepository) }&#10;                val attendanceViewModel = remember { com.example.attendance_tracker.viewmodel.AttendanceViewModel(attendanceRepository) }&#10;                Scaffold(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    bottomBar = {&#10;                        NavigationBar {&#10;                            val currentRoute = navController.currentBackStackEntry?.destination?.route&#10;                            items.forEach { item -&gt;&#10;                                NavigationBarItem(&#10;                                    icon = { Icon(item.icon, contentDescription = item.label) },&#10;                                    label = { Text(item.label) },&#10;                                    selected = currentRoute == item.route,&#10;                                    onClick = {&#10;                                        if (currentRoute != item.route) {&#10;                                            navController.navigate(item.route) {&#10;                                                popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                                launchSingleTop = true&#10;                                                restoreState = true&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                ) { innerPadding -&gt;&#10;                    AppNavHost(&#10;                        navController = navController,&#10;                        repository = repository,&#10;                        timetableViewModel = timetableViewModel,&#10;                        commonSlotViewModel = commonSlotViewModel,&#10;                        attendanceViewModel = attendanceViewModel,&#10;                        modifier = Modifier.padding(innerPadding)&#10;                    )&#10;                }&#10;&#10;                // Schedule Attendance Reminder Worker at 6 PM daily&#10;                val workManager = WorkManager.getInstance(applicationContext)&#10;                val now = Calendar.getInstance()&#10;                val sixPm = Calendar.getInstance().apply {&#10;                    set(Calendar.HOUR_OF_DAY, 18)&#10;                    set(Calendar.MINUTE, 0)&#10;                    set(Calendar.SECOND, 0)&#10;                    set(Calendar.MILLISECOND, 0)&#10;                }&#10;                var initialDelay = sixPm.timeInMillis - now.timeInMillis&#10;                if (initialDelay &lt; 0) {&#10;                    // If 6 PM already passed today, schedule for tomorrow&#10;                    initialDelay += TimeUnit.DAYS.toMillis(1)&#10;                }&#10;                val attendanceReminderRequest = PeriodicWorkRequestBuilder&lt;AttendanceReminderWorker&gt;(1, TimeUnit.DAYS)&#10;                    .setInitialDelay(initialDelay, TimeUnit.MILLISECONDS)&#10;                    .build()&#10;                workManager.enqueueUniquePeriodicWork(&#10;                    &quot;AttendanceReminderWork&quot;,&#10;                    ExistingPeriodicWorkPolicy.UPDATE,&#10;                    attendanceReminderRequest&#10;                )&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/data/AttendanceDao.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/data/AttendanceDao.kt" />
              <option name="originalContent" value="package com.example.attendance_tracker.data&#10;&#10;import androidx.room.*&#10;&#10;@Dao&#10;interface AttendanceDao {&#10;    @Query(&quot;DELETE FROM attendance WHERE subjectId = :subjectId&quot;)&#10;    suspend fun deleteAllForSubject(subjectId: Int)&#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#10;    suspend fun insertAttendance(attendance: Attendance)&#10;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId AND slotId = :slotId ORDER BY date DESC&quot;)&#10;    suspend fun getAttendanceForSlot(subjectId: Int, slotId: Int): List&lt;Attendance&gt;&#10;&#10;    // Insert manual update history&#10;    @Insert&#10;    suspend fun insertManualHistory(attendance: Attendance)&#10;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId ORDER BY date DESC&quot;)&#10;    suspend fun getAttendanceForSubject(subjectId: Int): List&lt;Attendance&gt;&#10;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId AND date = :date LIMIT 1&quot;)&#10;    suspend fun getAttendanceForSubjectOnDate(subjectId: Int, date: String): Attendance?&#10;&#10;    @Query(&quot;SELECT COUNT(*) FROM attendance WHERE subjectId = :subjectId AND status = :status&quot;)&#10;    suspend fun getCountByStatus(subjectId: Int, status: AttendanceStatus): Int&#10;&#10;    @Query(&quot;SELECT COUNT(*) FROM attendance WHERE subjectId = :subjectId&quot;)&#10;    suspend fun getTotalMarked(subjectId: Int): Int&#10;&#10;    @Query(&quot;DELETE FROM attendance WHERE subjectId = :subjectId AND date = :date&quot;)&#10;    suspend fun deleteAttendanceForSubjectOnDate(subjectId: Int, date: String)&#10;&#10;    @Query(&quot;UPDATE attendance SET status = :status WHERE subjectId = :subjectId AND date = :date&quot;)&#10;    suspend fun updateAttendanceStatusForSubjectOnDate(subjectId: Int, date: String, status: AttendanceStatus)&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.attendance_tracker.data&#13;&#10;&#13;&#10;import androidx.room.*&#13;&#10;&#13;&#10;@Dao&#13;&#10;interface AttendanceDao {&#13;&#10;    @Query(&quot;DELETE FROM attendance WHERE subjectId = :subjectId&quot;)&#13;&#10;    suspend fun deleteAllForSubject(subjectId: Int)&#13;&#10;    @Insert(onConflict = OnConflictStrategy.REPLACE)&#13;&#10;    suspend fun insertAttendance(attendance: Attendance)&#13;&#10;&#13;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId AND slotId = :slotId ORDER BY date DESC&quot;)&#13;&#10;    suspend fun getAttendanceForSlot(subjectId: Int, slotId: Int): List&lt;Attendance&gt;&#13;&#10;&#13;&#10;    // Insert manual update history&#13;&#10;    @Insert&#13;&#10;    suspend fun insertManualHistory(attendance: Attendance)&#13;&#10;&#13;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId ORDER BY date DESC&quot;)&#13;&#10;    suspend fun getAttendanceForSubject(subjectId: Int): List&lt;Attendance&gt;&#13;&#10;&#13;&#10;    @Query(&quot;SELECT * FROM attendance WHERE subjectId = :subjectId AND date = :date LIMIT 1&quot;)&#13;&#10;    suspend fun getAttendanceForSubjectOnDate(subjectId: Int, date: String): Attendance?&#13;&#10;&#13;&#10;    @Query(&quot;SELECT COUNT(*) FROM attendance WHERE subjectId = :subjectId AND status = :status&quot;)&#13;&#10;    suspend fun getCountByStatus(subjectId: Int, status: AttendanceStatus): Int&#13;&#10;&#13;&#10;    @Query(&quot;SELECT COUNT(*) FROM attendance WHERE subjectId = :subjectId&quot;)&#13;&#10;    suspend fun getTotalMarked(subjectId: Int): Int&#13;&#10;&#13;&#10;    @Query(&quot;DELETE FROM attendance WHERE subjectId = :subjectId AND date = :date&quot;)&#13;&#10;    suspend fun deleteAttendanceForSubjectOnDate(subjectId: Int, date: String)&#13;&#10;&#13;&#10;    @Query(&quot;UPDATE attendance SET status = :status WHERE subjectId = :subjectId AND date = :date&quot;)&#13;&#10;    suspend fun updateAttendanceStatusForSubjectOnDate(subjectId: Int, date: String, status: AttendanceStatus)&#13;&#10;&#13;&#10;    @Query(&quot;SELECT COUNT(*) FROM attendance WHERE date = :date&quot;)&#13;&#10;    suspend fun getAttendanceCountForDate(date: String): Int&#13;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/ui/components/TimetableEntryCard.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/ui/components/TimetableEntryCard.kt" />
              <option name="originalContent" value="&#10;&#10;" />
              <option name="updatedContent" value="&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/worker/AttendanceReminderWorker.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/attendance_tracker/worker/AttendanceReminderWorker.kt" />
              <option name="originalContent" value="package com.example.attendance_tracker.worker&#10;&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.content.Context&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.core.app.NotificationManagerCompat&#10;import androidx.work.CoroutineWorker&#10;import androidx.work.WorkerParameters&#10;import com.example.attendance_tracker.R&#10;import com.example.attendance_tracker.data.AppDatabase&#10;import java.time.LocalDate&#10;import java.time.format.DateTimeFormatter&#10;&#10;class AttendanceReminderWorker(&#10;    appContext: Context,&#10;    workerParams: WorkerParameters&#10;) : CoroutineWorker(appContext, workerParams) {&#10;    override suspend fun doWork(): Result {&#10;        val db = AppDatabase.getDatabase(applicationContext)&#10;        val attendanceDao = db.attendanceDao()&#10;        val today = LocalDate.now().format(DateTimeFormatter.ISO_DATE)&#10;        val attendanceCount = attendanceDao.getAttendanceCountForDate(today)&#10;        if (attendanceCount == 0) {&#10;            showNotification()&#10;        }&#10;        return Result.success()&#10;    }&#10;&#10;    private fun showNotification() {&#10;        val channelId = &quot;attendance_reminder_channel&quot;&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val name = &quot;Attendance Reminder&quot;&#10;            val descriptionText = &quot;Reminds you to mark your attendance.&quot;&#10;            val importance = NotificationManager.IMPORTANCE_DEFAULT&#10;            val channel = NotificationChannel(channelId, name, importance).apply {&#10;                description = descriptionText&#10;            }&#10;            val notificationManager: NotificationManager =&#10;                applicationContext.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;        val builder = NotificationCompat.Builder(applicationContext, channelId)&#10;            .setSmallIcon(R.drawable.ic_notification) // Ensure this icon exists&#10;            .setContentTitle(&quot;Attendance Reminder&quot;)&#10;            .setContentText(&quot;You haven't marked your attendance today. Tap to mark now!&quot;)&#10;            .setPriority(NotificationCompat.PRIORITY_DEFAULT)&#10;        with(NotificationManagerCompat.from(applicationContext)) {&#10;            notify(1001, builder.build())&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.attendance_tracker.worker&#10;&#10;import android.app.NotificationChannel&#10;import android.app.NotificationManager&#10;import android.content.Context&#10;import android.os.Build&#10;import androidx.core.app.NotificationCompat&#10;import androidx.core.app.NotificationManagerCompat&#10;import androidx.work.CoroutineWorker&#10;import androidx.work.WorkerParameters&#10;import com.example.attendance_tracker.R&#10;import com.example.attendance_tracker.data.AppDatabase&#10;import java.time.LocalDate&#10;import java.time.format.DateTimeFormatter&#10;&#10;class AttendanceReminderWorker(&#10;    appContext: Context,&#10;    workerParams: WorkerParameters&#10;) : CoroutineWorker(appContext, workerParams) {&#10;    override suspend fun doWork(): Result {&#10;        val db = AppDatabase.getDatabase(applicationContext)&#10;        val attendanceDao = db.attendanceDao()&#10;        val today = LocalDate.now().format(DateTimeFormatter.ISO_DATE)&#10;        val attendanceCount = attendanceDao.getAttendanceCountForDate(today)&#10;        if (attendanceCount == 0) {&#10;            showNotification()&#10;        }&#10;        return Result.success()&#10;    }&#10;&#10;    private fun showNotification() {&#10;        val channelId = &quot;attendance_reminder_channel&quot;&#10;        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {&#10;            val name = &quot;Attendance Reminder&quot;&#10;            val descriptionText = &quot;Reminds you to mark your attendance.&quot;&#10;            val importance = NotificationManager.IMPORTANCE_DEFAULT&#10;            val channel = NotificationChannel(channelId, name, importance).apply {&#10;                description = descriptionText&#10;            }&#10;            val notificationManager: NotificationManager =&#10;                applicationContext.getSystemService(Context.NOTIFICATION_SERVICE) as NotificationManager&#10;            notificationManager.createNotificationChannel(channel)&#10;        }&#10;        val builder = NotificationCompat.Builder(applicationContext, channelId)&#10;            .setSmallIcon(R.mipmap.ic_launcher) // Use app icon for notification&#10;            .setContentTitle(&quot;Attendance Reminder&quot;)&#10;            .setContentText(&quot;You haven't marked your attendance today. Tap to mark now!&quot;)&#10;            .setPriority(NotificationCompat.PRIORITY_DEFAULT)&#10;        with(NotificationManagerCompat.from(applicationContext)) {&#10;            notify(1001, builder.build())&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lol/MainActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lol/MainActivity.kt" />
              <option name="originalContent" value="package com.example.lol&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import com.example.lol.ui.navigation.AppNavHost&#10;import com.example.lol.ui.navigation.BottomNavItem&#10;import com.example.lol.ui.theme.LOLTheme&#10;import androidx.navigation.compose.rememberNavController&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.School&#10;import androidx.compose.material.icons.filled.List&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.room.Room&#10;import com.example.lol.data.AppDatabase&#10;import com.example.lol.data.SubjectRepository&#10;import com.example.lol.repository.TimetableRepository&#10;import com.example.lol.viewmodel.TimetableViewModel&#10;import com.example.lol.viewmodel.TimetableViewModelFactory&#10;import androidx.compose.runtime.remember&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        setContent {&#10;            LOLTheme {&#10;                val navController = rememberNavController()&#10;                val context = this&#10;                val db = remember {&#10;                    Room.databaseBuilder(&#10;                        context.applicationContext,&#10;                        AppDatabase::class.java,&#10;                        &quot;attendance_db&quot;&#10;                    )&#10;                    .fallbackToDestructiveMigration()&#10;                    .build()&#10;                }&#10;                val repository = remember { SubjectRepository(db.subjectDao()) }&#10;                val timetableRepository = remember { TimetableRepository(db.timetableDao()) }&#10;                val timetableViewModel: TimetableViewModel = androidx.lifecycle.viewmodel.compose.viewModel(&#10;                    factory = TimetableViewModelFactory(timetableRepository)&#10;                )&#10;                val items = listOf(&#10;                    BottomNavItem.Home,&#10;                    BottomNavItem.Subjects,&#10;                    BottomNavItem.Timetable,&#10;                    BottomNavItem.CommonSlots&#10;                )&#10;                val commonSlotViewModel: com.example.lol.viewmodel.CommonSlotViewModel = androidx.lifecycle.viewmodel.compose.viewModel()&#10;                // Always call insertDefaultSlotsIfEmpty; it only inserts if table is empty&#10;                commonSlotViewModel.insertDefaultSlotsIfEmpty()&#10;                val attendanceRepository = remember { com.example.lol.repository.AttendanceRepository(db.attendanceDao(), db.subjectDao()) }&#10;                val attendanceViewModel = remember { com.example.lol.viewmodel.AttendanceViewModel(attendanceRepository) }&#10;                Scaffold(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    bottomBar = {&#10;                        NavigationBar {&#10;                            val currentRoute = navController.currentBackStackEntry?.destination?.route&#10;                            items.forEach { item -&gt;&#10;                                NavigationBarItem(&#10;                                    icon = { Icon(item.icon, contentDescription = item.label) },&#10;                                    label = { Text(item.label) },&#10;                                    selected = currentRoute == item.route,&#10;                                    onClick = {&#10;                                        if (currentRoute != item.route) {&#10;                                            navController.navigate(item.route) {&#10;                                                popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                                launchSingleTop = true&#10;                                                restoreState = true&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                ) { innerPadding -&gt;&#10;                    AppNavHost(&#10;                        navController = navController,&#10;                        repository = repository,&#10;                        timetableViewModel = timetableViewModel,&#10;                        commonSlotViewModel = commonSlotViewModel,&#10;                        attendanceViewModel = attendanceViewModel,&#10;                        modifier = Modifier.padding(innerPadding)&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.lol&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import com.example.lol.ui.navigation.AppNavHost&#10;import com.example.lol.ui.navigation.BottomNavItem&#10;import com.example.lol.ui.theme.LOLTheme&#10;import androidx.navigation.compose.rememberNavController&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.School&#10;import androidx.compose.material.icons.filled.List&#10;import androidx.compose.material.icons.filled.Home&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.room.Room&#10;import com.example.lol.data.AppDatabase&#10;import com.example.lol.data.SubjectRepository&#10;import com.example.lol.repository.TimetableRepository&#10;import com.example.lol.viewmodel.TimetableViewModel&#10;import com.example.lol.viewmodel.TimetableViewModelFactory&#10;import androidx.compose.runtime.remember&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        setContent {&#10;            LOLTheme {&#10;                val navController = rememberNavController()&#10;                val context = this&#10;                val db = remember {&#10;                    Room.databaseBuilder(&#10;                        context.applicationContext,&#10;                        AppDatabase::class.java,&#10;                        &quot;attendance_db&quot;&#10;                    )&#10;                    .fallbackToDestructiveMigration()&#10;                    .build()&#10;                }&#10;                val repository = remember { SubjectRepository(db.subjectDao()) }&#10;                val timetableRepository = remember { TimetableRepository(db.timetableDao()) }&#10;                val timetableViewModel: TimetableViewModel = androidx.lifecycle.viewmodel.compose.viewModel(&#10;                    factory = TimetableViewModelFactory(timetableRepository)&#10;                )&#10;                val items = listOf(&#10;                    BottomNavItem.Home,&#10;                    BottomNavItem.Subjects,&#10;                    BottomNavItem.Timetable,&#10;                    BottomNavItem.CommonSlots&#10;                )&#10;                val commonSlotViewModel: com.example.lol.viewmodel.CommonSlotViewModel = androidx.lifecycle.viewmodel.compose.viewModel()&#10;                // Always call insertDefaultSlotsIfEmpty; it only inserts if table is empty&#10;                commonSlotViewModel.insertDefaultSlotsIfEmpty()&#10;                val attendanceRepository = remember { com.example.lol.repository.AttendanceRepository(db.attendanceDao(), db.subjectDao(), repository) }&#10;                val attendanceViewModel = remember { com.example.lol.viewmodel.AttendanceViewModel(attendanceRepository) }&#10;                Scaffold(&#10;                    modifier = Modifier.fillMaxSize(),&#10;                    bottomBar = {&#10;                        NavigationBar {&#10;                            val currentRoute = navController.currentBackStackEntry?.destination?.route&#10;                            items.forEach { item -&gt;&#10;                                NavigationBarItem(&#10;                                    icon = { Icon(item.icon, contentDescription = item.label) },&#10;                                    label = { Text(item.label) },&#10;                                    selected = currentRoute == item.route,&#10;                                    onClick = {&#10;                                        if (currentRoute != item.route) {&#10;                                            navController.navigate(item.route) {&#10;                                                popUpTo(navController.graph.startDestinationId) { saveState = true }&#10;                                                launchSingleTop = true&#10;                                                restoreState = true&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;                ) { innerPadding -&gt;&#10;                    AppNavHost(&#10;                        navController = navController,&#10;                        repository = repository,&#10;                        timetableViewModel = timetableViewModel,&#10;                        commonSlotViewModel = commonSlotViewModel,&#10;                        attendanceViewModel = attendanceViewModel,&#10;                        modifier = Modifier.padding(innerPadding)&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lol/repository/AttendanceRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lol/repository/AttendanceRepository.kt" />
              <option name="originalContent" value="package com.example.lol.repository&#10;import com.example.lol.data.Attendance&#10;import com.example.lol.data.AttendanceDao&#10;import com.example.lol.data.AttendanceStatus&#10;import com.example.lol.data.SubjectRepository&#10;import com.example.lol.data.SubjectDao&#10;import com.example.lol.data.Subject&#10;&#10;class AttendanceRepository(private val attendanceDao: AttendanceDao, private val subjectDao: SubjectDao) {&#10;    suspend fun markAttendanceForSlot(subjectId: Int, slotId: Int, date: String, status: AttendanceStatus) {&#10;        val attendance = Attendance(subjectId = subjectId, slotId = slotId, date = date, status = status)&#10;        attendanceDao.insertAttendance(attendance)&#10;    }&#10;&#10;    suspend fun deleteAllAttendanceForSubject(subjectId: Int) {&#10;        attendanceDao.deleteAllForSubject(subjectId)&#10;    }&#10;&#10;    suspend fun getSubjectById(subjectId: Int): Subject? {&#10;        return subjectDao.getSubjectById(subjectId)&#10;    }&#10;    &#10;    suspend fun addManualHistory(subjectId: Int, date: String, note: String) {&#10;        val manual = Attendance(subjectId = subjectId, slotId = -1, date = date, status = AttendanceStatus.PRESENT, note = note)&#10;        attendanceDao.insertManualHistory(manual)&#10;    }&#10;&#10;    suspend fun updateSubjectAttendance(subjectId: Int, attended: Int, total: Int) {&#10;        val subject = subjectDao.getSubjectById(subjectId)&#10;        if (subject != null) {&#10;            val updated = subject.copy(attendedClasses = attended, totalClasses = total)&#10;            subjectDao.updateSubject(updated)&#10;            // Notify SubjectRepository to refresh subjects&#10;            SubjectRepository(subjectDao).refreshSubjects()&#10;        }&#10;    }&#10;&#10;    suspend fun getAttendanceHistory(subjectId: Int) = attendanceDao.getAttendanceForSubject(subjectId)&#10;&#10;    suspend fun getAttendanceForDate(subjectId: Int, date: String) = attendanceDao.getAttendanceForSubjectOnDate(subjectId, date)&#10;&#10;    suspend fun getAttendancePercentage(subjectId: Int): Double {&#10;        val total = attendanceDao.getTotalMarked(subjectId)&#10;        if (total == 0) return 0.0&#10;        val present = attendanceDao.getCountByStatus(subjectId, AttendanceStatus.PRESENT)&#10;        return (present.toDouble() / total) * 100&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.lol.repository&#10;import com.example.lol.data.Attendance&#10;import com.example.lol.data.AttendanceDao&#10;import com.example.lol.data.AttendanceStatus&#10;import com.example.lol.data.SubjectRepository&#10;import com.example.lol.data.SubjectDao&#10;import com.example.lol.data.Subject&#10;&#10;class AttendanceRepository(&#10;    private val attendanceDao: AttendanceDao,&#10;    private val subjectDao: SubjectDao,&#10;    private val subjectRepository: SubjectRepository // Injected shared instance&#10;) {&#10;    suspend fun markAttendanceForSlot(subjectId: Int, slotId: Int, date: String, status: AttendanceStatus) {&#10;        val attendance = Attendance(subjectId = subjectId, slotId = slotId, date = date, status = status)&#10;        attendanceDao.insertAttendance(attendance)&#10;    }&#10;&#10;    suspend fun deleteAllAttendanceForSubject(subjectId: Int) {&#10;        attendanceDao.deleteAllForSubject(subjectId)&#10;    }&#10;&#10;    suspend fun getSubjectById(subjectId: Int): Subject? {&#10;        return subjectDao.getSubjectById(subjectId)&#10;    }&#10;    &#10;    suspend fun addManualHistory(subjectId: Int, date: String, note: String) {&#10;        val manual = Attendance(subjectId = subjectId, slotId = -1, date = date, status = AttendanceStatus.PRESENT, note = note)&#10;        attendanceDao.insertManualHistory(manual)&#10;    }&#10;&#10;    suspend fun updateSubjectAttendance(subjectId: Int, attended: Int, total: Int) {&#10;        val subject = subjectDao.getSubjectById(subjectId)&#10;        if (subject != null) {&#10;            val updated = subject.copy(attendedClasses = attended, totalClasses = total)&#10;            subjectDao.updateSubject(updated)&#10;            // Notify shared SubjectRepository to refresh subjects&#10;            subjectRepository.refreshSubjects()&#10;        }&#10;    }&#10;&#10;    suspend fun getAttendanceHistory(subjectId: Int) = attendanceDao.getAttendanceForSubject(subjectId)&#10;&#10;    suspend fun getAttendanceForDate(subjectId: Int, date: String) = attendanceDao.getAttendanceForSubjectOnDate(subjectId, date)&#10;&#10;    suspend fun getAttendancePercentage(subjectId: Int): Double {&#10;        val total = attendanceDao.getTotalMarked(subjectId)&#10;        if (total == 0) return 0.0&#10;        val present = attendanceDao.getCountByStatus(subjectId, AttendanceStatus.PRESENT)&#10;        return (present.toDouble() / total) * 100&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>